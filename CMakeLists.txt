# Copyright David Callu 2013
#
# Distributed under the Boost Software License, Version 1.0.
#    (See accompanying file LICENSE_1_0.txt or copy at
#          http://www.boost.org/LICENSE_1_0.txt)



########################################################################################################################
########################################################################################################################
#
# define minimum cmake version
#
########################################################################################################################
########################################################################################################################
cmake_minimum_required(VERSION 3.6.1)
cmake_policy(VERSION 3.6)


include(cmake/HunterGate.cmake)
HunterGate(
    URL "https://github.com/ruslo/hunter/archive/v0.15.23.tar.gz"
    SHA1 "ab53ab9ede1cba3b894ed9e17a26f091924f6d65"
)



########################################################################################################################
########################################################################################################################
#
# define project name/version
#
########################################################################################################################
########################################################################################################################
project(gen_prog VERSION 0.1.0)
string(TIMESTAMP ${PROJECT_NAME}_BUILD_TIME "%Y-%m-%d %H:%M:%S UTC" UTC)




########################################################################################################################
########################################################################################################################
#
# define CMake Module path
#
########################################################################################################################
########################################################################################################################
list(INSERT CMAKE_MODULE_PATH 0
    ${CMAKE_HOME_DIRECTORY}/cmake
    $ENV{CMUT_DIR}
)

# cmut's module
include( cmut_define_output_dirs )
include( cmut_define_install_dirs )
include( cmut_get_git_info )

include( cmut__build )
include( cmut__install )
include( cmut__config )
include( cmut__target )


cmut__config__option_developer_mode()



########################################################################################################################
########################################################################################################################
#
# find dependencies
#
########################################################################################################################
########################################################################################################################
include("${CMAKE_CURRENT_LIST_DIR}/cmake/dependencies/include_all.cmake")



########################################################################################################################
########################################################################################################################
#
# define build policies
#
########################################################################################################################
########################################################################################################################

set(CMAKE_DEBUG_POSTFIX "d")

# define CMAKE_*_OUTPUT_DIRECTORY
cmut_define_output_dirs()
# add option to enable build with all cpu's core when use Visual Studio or nmake
cmut__build__msvc__option_use_mp()

# enable C++14
cmut__build__enable_cxx_standard(14)

# enable warning
cmut__build__enable_warning()

# use RUNPATH instead of depreciated RPATH
cmut__build__enable_runpath_link()

cmut__build__set_cxx_visibility(hidden)

if (MSVC)
    add_definitions(-DUNICODE)
endif()



########################################################################################################################
########################################################################################################################
#
# add subdirectories
#
########################################################################################################################
########################################################################################################################

include_directories(${CMAKE_SOURCE_DIR}/3rdParties/gen_prog/include)
add_subdirectory(src)

if(DOXYGEN_FOUND)
#    add_subdirectory(doc)
endif()

include(CTest)
if(BUILD_TESTING)
    enable_testing()
    add_subdirectory(test)
endif()



########################################################################################################################
########################################################################################################################
#
# define install policies
#
########################################################################################################################
########################################################################################################################

cmut__install__install_config_and_version()
cmut__install__install_config_directory(
    DIRECTORY       "cmake/dependencies"
    DESTINATION .)


########################################################################################################################
########################################################################################################################
#
# define uninstall policies
#
########################################################################################################################
########################################################################################################################

include(cmut_define_uninstall_target)

